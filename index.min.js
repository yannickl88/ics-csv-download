!function(){let e=[];for(let t of document.querySelectorAll(".statement-table > div div[role=button]"))e.push(Promise.resolve(t).then(e=>new Promise(t=>{let n=e.parentElement.parentElement;if(e.classList.contains("statement-header--is-expanded")){t(n.querySelector("ics-transaction-list"));return}e.click();let r=setInterval(()=>{let e=n.querySelector("ics-transaction-list");e&&(clearInterval(r),t(e))},500)}).then(e=>{let t=parseInt(e.parentElement.querySelector(".statement-header__period").textContent.trim().split(" ").pop()),n=[];return e.querySelectorAll("ics-transaction").forEach(e=>{e.querySelector("div.row.b-transaction-header--has-details:not(.expanded)")?.click();let r=(e.querySelector(".b-transaction-details__merchantCategoryCodeDescription")?.textContent??"").trim(),o=e.querySelector(".b-transaction-header__description-wrapper .b-transaction-header__description").textContent.trim(),i=e.querySelector(".i-no-line-height").textContent.trim().split("\n")[0].trim().split(" "),a=parseInt(i[0]),l={jan:0,feb:1,mrt:2,apr:3,mei:4,jun:5,jul:6,aug:7,sep:8,okt:9,nov:10,dec:11}[i[1].substring(0,3)],s=new Date(t,l,a),c=e.querySelectorAll(".billingAmountBlock div span.i-float-right"),p=c[0].textContent.trim().substring(2).replace(".","").replace(",",".");"af"===c[1].textContent.trim().toLowerCase()&&(p="-"+p),n.push([s.toLocaleDateString("en-US"),o,r,p])}),n})));Promise.all(e).then(e=>e.flat()).then(e=>{let t="Date,Payee,Memo,Amount\n";for(let n of e)t+='"'+n.join('","')+'"\n';let r=new Blob([t],{type:"text/csv"}),o=window.URL.createObjectURL(r);window.location.assign(o)})}();
