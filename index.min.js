!function(e){let t=[],n={jan:0,feb:1,mrt:2,apr:3,mei:4,jun:5,jul:6,aug:7,sep:8,okt:9,nov:10,dec:11};for(let r of document.querySelectorAll(".statement-table > div div[role=button]"))t.push(Promise.resolve(r).then(t=>new Promise(e=>{let n=t.parentElement.parentElement;if(t.classList.contains("statement-header--is-expanded")){e(n.querySelector("ics-transaction-list"));return}t.click();let r=setInterval(()=>{let t=n.querySelector("ics-transaction-list");t&&(clearInterval(r),e(t))},500)}).then(t=>{let r=t.parentElement.querySelector(".statement-header__period").textContent.trim(),a=r.match(/^[0-9]+ ([a-z]+)\.?\s+t\/m\s+[0-9]+ ([a-z]+)\.? ([0-9]+)$/),i={},l=parseInt(a[3]),o=n[a[2]],s=n[a[1]];if(s>o)for(let c=s;c<=o+12;c++)i[c%12]=l-(Math.ceil((s-o)/12)-Math.floor(c/12));else for(let m=s;m<=o;m++)i[m]=l;let p=[];return t.querySelectorAll("ics-transaction").forEach(t=>{t.querySelector(".b-transaction-header.b-transaction-header--has-details:not(.expanded)")?.click();let r=(t.querySelector(".b-transaction-details__merchantCategoryCodeDescription")?.textContent??"").trim(),a=t.querySelector(".b-transaction-header__description-wrapper .b-transaction-header__description").textContent.trim(),o=t.querySelector(".i-no-line-height").textContent.trim().split("\n")[0].trim().split(" "),s=parseInt(o[0]),c=n[o[1].substring(0,3)],m=c+1,u=t.querySelectorAll(".b-transaction-payment__amount div span.i-float-right"),d=u[0].textContent.trim().substring(2).replace(".","");"af"===u[1].textContent.trim().toLowerCase()&&(d="-"+d),s<10&&(s="0"+s),m<10&&(m="0"+m);let h=s+"/"+m+"/"+(i[c]??l);p.push([h,d,e,"",a.replace(";",""),r.replace(";","")])}),p})));Promise.all(t).then(e=>e.flat()).then(e=>{let t="Datum;Bedrag;Eigen Rekening;Tegen Rekening;Omschrijving 1;Omschrijving 2\n";for(let n of e)t+=n.join(";")+"\n";let r=new Blob([t],{type:"text/csv"}),a=window.URL.createObjectURL(r);window.location.assign(a)})}("!!REPLACE ME!!");
